# 项目背景和现状

恶意软件的威胁日益突显，对网络安全构成了巨大的挑战，尽管关于恶意软件检测的研究层出不穷，但大多数恶意软件分析工具只能输出相关的恶意标签或确定程序类别，无法判断出关键的恶意模块位置及其攻击方式。要精准地定位恶意模块在软件中的具体位置，受到其多样性和变异性的制约，数据流分析和行为分析的复杂性也增加了对模块执行路径和恶意行为的理解难度。因此恶意模块定位的自动化一直是一个具有挑战性的问题。

传统的恶意软件检测领域通常采用静态或动态分析技术。静态分析关注程序结构和机器代码,通过反汇编、反编译、代码审查和字符串分析等手段，揭示潜在的恶意行为和特征；动态分析关注实际执行过程中的数据和行为以及运行环境、交互，挖掘软件漏洞或恶意行为。然而，这些传统技术难以深入到恶意模块的具体细节，难以实现准确定位。

因此，本项目将研究一种基于静态分析与 hook 技术相结合的恶意模块定位方法，通过导出恶意软件的 CFG，加以分析，找出恶意模块的位置，然后通过 hook 技术，监控恶意模块的执行和调用栈，获取其具体的恶意行为。最终实现对恶意模块的定位和行为分析。

# 研究内容和目标

本项目的研究内容主要包括：

1. 恶意软件不同恶意模块的识别与定位。简单来说，就是找出恶意软件中的恶意模块，确定其位置。定位的粒度可以是函数级别，也可以是模块级别。
2. 恶意模块的行为分析。通过 hook 技术，监控恶意模块的执行和调用栈，获取其具体的恶意行为。具体而言，对于不同的模块，可以监控其文件操作、网络操作、注册表操作等。我们会使用技战术的方式，对恶意模块进行行为标记。
3. 尝试对恶意软件进行拆分，将使用不同技战术的模块与正常模块分离。以确定先前行为标记的准确性。

# 技术路线

1. 恶意行为识别：我们将使用 hook 技术，监控恶意软件调用的系统 API、文件操作、网络操作等，制作出操作与技战术的映射关系。
2. 恶意模块定位：我们将使用静态分析技术，对恶意软件进行反汇编，提取出其 CFG，然后通过 CFG 分析并结合 hook 技术打印的堆栈记录，使用最近公共祖先（LCA）算法，在尽量大的粒度上定位恶意模块的位置。
3. 验证与评估：我们将使用相关的二进制库过滤相关的函数，再使用沙箱环境进行验证，确保软件的恶意行为已被清除。

# 进度计划

- 第一阶段：恶意行为识别（第一周——第二周）
- 第二阶段：恶意模块定位（第三周——第四周）
- 第三阶段：恶意模块拆分（第五周——第七周）
- 第四阶段：论文撰写或竞赛原型系统设计（第八周——第十二周）
