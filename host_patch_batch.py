import re, os
file = open("ttp_from_stacktrace_per_line_new.txt", "r")
lines = file.readlines()

for line in lines:
    line = line.strip()
    pattern = r'\{.*\}'
    match = re.search(pattern, line)
    if match:
        content = eval(match.group(0))
        if len(content) == 1:
            print("len is 1")
            continue
    else:
        continue

    pattern = r'\S+\.txt'
    match = re.search(pattern, line)
    if match:
        filename = match.group(0)[:-4]
        print(filename)
        print("sh host_patch.sh ../malware_sample_without_packer/{0} output_folder".format(filename))
        os.system("sh host_patch.sh ../malware_sample_without_packer/{0} output_folder".format(filename))
    else:
        print("error on " + line)
