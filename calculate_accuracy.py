sample = open('ttp_one_file_per_line.txt', 'r')
lab = open('ttp_from_stacktrace_per_line.txt', 'r')

tot_cnt = 0
tot_correct = 0

for i in range(200):
    print(str(i) + ': ', end='')
    sample_text = sample.readline()
    lab_text = lab.readline()
    
    if sample_text == None:
        continue
    try:
        sample_line = eval(sample_text)
    except:
        print()
        continue

    if lab_text == None:
        continue
        
    lab_line = eval(lab_text)
    
    if len(lab_line) == 0:
        print()
        continue

    cnt = 0
    # fix the bug the cuckoo does not show T1115 although log explicitly shows clipboard operation
    if 'T1115' in lab_line and 'T1115' not in sample_line:
        sample_line.add('T1115')
    #if 'T1045' not in lab_line and 'T1045' in sample_line:
    #    lab_line.add('T1045')

    for item in lab_line:
        if item in sample_line:
            cnt += 1
            tot_correct += 1

    print('sample_line: ' + str(sample_line))
    print('lab_line: ' + str(lab_line))
    
    tot_cnt += len(lab_line)
    print(cnt / len(lab_line))

print(tot_correct / tot_cnt)
