import json


outputfile = open('ttp_one_file_per_line.txt', 'w')

def output_ttp(filename):
# Load the report.json file
    with open(filename) as f:
        report = json.load(f)

    # Extract all TTPs
    ttps = set()
    for signature in report['signatures']:
        if signature['ttp']:
            ttps.update(signature['ttp'].keys())

    # Print all TTPs
    if ttps:
        outputfile.write(str(ttps) + '\n')
    else:
        outputfile.write('\n')

parent_dir = '/home/junyu33/.cuckoo/storage/analyses/'
for i in range(1, 201):
    filename = parent_dir + str(i) + '/reports/report.json'
    output_ttp(filename)
